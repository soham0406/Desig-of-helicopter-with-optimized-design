---
title: "616project-29/4"
author: "Soham Patil"
date: "4/29/2021"
output: word_document
editor_options: 
  chunk_output_type: console
---
1) Reading all the excel files
```{r}
library(faraway)
library(readxl)
HALFNORMALY <- read_excel("C:/Users/soham/OneDrive/Desktop/Soham MS/ISEN SEM 1/616/Project/MAINEFFECTY.xlsx")
HALFNORMALD <- read_excel("C:/Users/soham/OneDrive/Desktop/Soham MS/ISEN SEM 1/616/Project/MAINEFFECTD.xlsx")
HAMADAY <- read_excel("C:/Users/soham/OneDrive/Desktop/Soham MS/ISEN SEM 1/616/Project/HWY.xlsx")
HAMADAD <- read_excel("C:/Users/soham/OneDrive/Desktop/Soham MS/ISEN SEM 1/616/Project/HWD.xlsx")
View(HALFNORMALY)
View(HALFNORMALD)
View(HAMADAY)
View(HAMADAD)
```

PLotting Half normal plots for Location and Dispersion:

```{r}
x = halfnorm(HALFNORMALY$MEY, nlab= 11, labs = as.character(HALFNORMALY$RUN), ylab = "Location",)
y = halfnorm(HALFNORMALD$MED, nlab= 11, labs = as.character(HALFNORMALD$RUN), ylab = "Dispersion",)
```

Performing the Hamda Wu method for the Location equation:

```{r}
library(ISLR)
library(leaps)
library(olsrr)


regfitLOCATION=lm(Y~A+B+C+D+E+F,data=HAMADAY)
ols_step_both_p(regfitLOCATION)
summary(regfitLOCATION)
regfitA=lm(Y~A+AB+AC+AD+AE+AF,data=HAMADAY)
ols_step_both_p(regfitA)
summary(regfitA)
regfitB=lm(Y~B+AB+BC+BD+BE+BF,data=HAMADAY)
ols_step_both_p(regfitB)
summary(regfitB)
regfitC=lm(Y~C+AC+BC+CD+CE+CF,data=HAMADAY)
ols_step_both_p(regfitC)
summary(regfitC)
regfitD=lm(Y~D+AD+BD+CD+DE+DF,data=HAMADAY)
ols_step_both_p(regfitD)
summary(regfitD)
regfitE=lm(Y~E+AE+BE+CE+DE+EF,data=HAMADAY)
ols_step_both_p(regfitE)
summary(regfitE)
regfitF=lm(Y~F+AF+BF+CF+DF+EF,data=HAMADAY)
ols_step_both_p(regfitF)
summary(regfitF)
```

From the initial 6 steps we can see that the significant 2fi are- BD, CF, DE, CF.
Hence for the second step we need to include all the main effects and the 2fi that are significant in the first step.


Iteration 1)
```{r}
regfitall1=lm(Y~A+B+C+D+E+F+BD+CF+DE+CF,data=HAMADAY)
ols_step_both_p(regfitall1)
summary(regfitall1)
```

From the first iteration we see that the significant effects are- A, DE AND BD.
Applying Effect Heredity principal we can see that the 2 fi- CE and BD are not significant as none of their parent terms are significant.
Hence removing them and performing the second iteration as following:

Iteration 2)
```{r}
regfitall2=lm(Y~A+B+C+D+E+F,data=HAMADAY)
ols_step_both_p(regfitall2)
summary(regfitall2)

```

From the results we can see that only Factor A is significant which refers to "l" in the helicopter which is the "wing length"


We have to repeat the same procedure for Dispersion equation
DISPERSION
```{r}
regfitDISPERSION=lm(S~A+B+C+D+E+F,data=HAMADAD)
ols_step_both_p(regfitDISPERSION)
summary(regfitDISPERSION)
regfit1=lm(S~A+AB+AC+AD+AE+AF,data=HAMADAD)
ols_step_both_p(regfit1)
summary(regfit1)
regfit2=lm(S~B+AB+BC+BD+BE+BF,data=HAMADAD)
ols_step_both_p(regfit2)
summary(regfit2)
regfit3=lm(S~C+AC+BC+CD+CE+CF,data=HAMADAD)
ols_step_both_p(regfit3)
summary(regfit3)
regfit4=lm(S~D+AD+BD+CD+DE+DF,data=HAMADAD)
ols_step_both_p(regfit4)
summary(regfit4)
regfit5=lm(S~E+AE+BE+CE+DE+EF,data=HAMADAD)
ols_step_both_p(regfit5)
summary(regfit5)
regfit6=lm(S~F+AF+BF+CF+DF+EF,data=HAMADAD)
ols_step_both_p(regfit6)
summary(regfit6)
```

From the first step we understand that the significant 2fi are as following-AD and BC
Hence we perform the first iteration including these interaction terms and the main effects.


Iteration 1)
```{r}
regfitAll1=lm(S~A+B+C+D+E+F+AD+BC,data=HAMADAD)
ols_step_both_p(regfitAll1)
summary(regfitAll1)
```

Hence from the first iteration we can conclude that the significant terms are : BC, F, AD, B
From Effect Heredity principal we remove factor interaction AD as none of its parent factors are coming as significant.


Now we have to perform second iteration by removing AD
Iteration 2)
```{r}
regfitAll2=lm(S~A+B+C+D+E+F+BC,data=HAMADAD)
ols_step_both_p(regfitAll2)
summary(regfitAll2)
```

After performing Second iteration we can see that the significant effects are BC, F and B which will not further change.